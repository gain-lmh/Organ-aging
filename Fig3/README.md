Source codes for Fig.3
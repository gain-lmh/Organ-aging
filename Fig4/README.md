Source codes for Fig.4